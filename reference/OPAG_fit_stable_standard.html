<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>creates stable standard based on optimizing the growth rate — OPAG_fit_stable_standard • DemoTools</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="creates stable standard based on optimizing the growth rate — OPAG_fit_stable_standard" />
<meta property="og:description" content="The stationary standard, nLx is transformed into a stable standard by optimizing a growth rate, r such that the stable standard matches observed population counts in selected age groups. Usually the ages used for fitting are wide age groups in older ages preceding the open age group. The standard output by this function is used by OPAG to creat the standard used to redistribute counts over older age groups up to a specified open age group, such as 100." />
<meta property="og:image" content="https://timriffe.github.io/DemoTools/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-reverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DemoTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">01.12.06</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Short manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Age-heaping_quality_with_Demotools.html">Handle age heaping</a>
    </li>
    <li>
      <a href="../articles/graduation_with_demotools.html">Graduate demographic counts</a>
    </li>
    <li>
      <a href="../articles/smoothing_with_demotools.html">Smooth demographic counts</a>
    </li>
    <li>
      <a href="../articles/lifetables_with_demotools.html">Construct a lifetable</a>
    </li>
    <li>
      <a href="../articles/migration_with_demotools.html">Model migration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/case_study_1.html">Case study</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/timriffe1">
    <span class="fas fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/timriffe/DemoTools/">
    <span class="fas fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>creates stable standard based on optimizing the growth rate</h1>
    <small class="dont-index">Source: <a href='https://github.com/timriffe/DemoTools/blob/master/R/OPAG.R'><code>R/OPAG.R</code></a></small>
    <div class="hidden name"><code>OPAG_fit_stable_standard.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The stationary standard, <code>nLx</code> is transformed into a stable standard by optimizing a growth rate, <code>r</code> such that the stable standard matches observed population counts in selected age groups. Usually the ages used for fitting are wide age groups in older ages preceding the open age group. The standard output by this function is used by <code>OPAG</code> to creat the standard used to redistribute counts over older age groups up to a specified open age group, such as 100.</p>
    </div>

    <pre class="usage"><span class='fu'>OPAG_fit_stable_standard</span><span class='op'>(</span>
  <span class='va'>Pop_fit</span>,
  <span class='va'>Age_fit</span>,
  <span class='va'>AgeInt_fit</span>,
  <span class='va'>nLx</span>,
  <span class='va'>Age_nLx</span>,
  <span class='va'>AgeInt_nLx</span>,
  method <span class='op'>=</span> <span class='st'>"uniform"</span>,
  continuous <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Pop_fit</th>
      <td><p>numeric vector of at least two population counts to use for fitting</p></td>
    </tr>
    <tr>
      <th>Age_fit</th>
      <td><p>integer vector of lower bounds for age groups of <code>Pop_fit</code></p></td>
    </tr>
    <tr>
      <th>AgeInt_fit</th>
      <td><p>integer vector of widths of age groups of <code>Pop_fit</code></p></td>
    </tr>
    <tr>
      <th>nLx</th>
      <td><p>numeric vector of stable population standard</p></td>
    </tr>
    <tr>
      <th>Age_nLx</th>
      <td><p>integer vector of lower bounds for age groups of <code>nLx</code></p></td>
    </tr>
    <tr>
      <th>AgeInt_nLx</th>
      <td><p>optional integer vector of widths of age groups of <code>nLx</code>, inferred if not given.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character. Graduation method, default <code>"uniform"</code>. <code>"mono"</code> or <code>"pclm"</code> would also be good choices.</p></td>
    </tr>
    <tr>
      <th>continuous</th>
      <td><p>logical. If <code>TRUE</code> we use the growth adjustment. <code>e^(-age*r)</code>. If <code>FALSE</code> we assume <code>r</code> is geometric growth, and we use <code>(1+r)^age</code> for the growth adjustment.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>list constaining</p><ol>
<li><p><code>Standard</code> numeric vector, the transformed <code>nLx</code> to be used for
redistribution in <code><a href='OPAG.html'>OPAG()</a></code></p></li>
<li><p>r_opt the output of <code><a href='https://rdrr.io/r/stats/optimize.html'>optimize()</a></code>, where <code>min</code> is the growth parameter, <code>r</code></p></li>
</ol>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The arguments <code>method</code> and <code>continous</code> don't have much leverage on the result. In short, the stable population transformation is done by ungrouping <code>nLx</code> to single ages (if it isn't already), and <code>method</code> controls which graduation method is used for this, where <code>"uniform"</code>, <code>"mono"</code>, <code>"pclm"</code> are the reasonable choices at this writing. In single ages, the difference between using a geometric <code>r</code> versus continuous <code>r</code> are quite small for this task.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>Pop_fit</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>85000</span>,<span class='fl'>37000</span><span class='op'>)</span>
<span class='va'>Age_fit</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>70</span>,<span class='fl'>80</span><span class='op'>)</span>
<span class='va'>AgeInt_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>10</span><span class='op'>)</span>
<span class='va'>nLx</span>        <span class='op'>&lt;-</span> <span class='fu'><a href='downloadnLx.html'>downloadnLx</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='st'>"Spain"</span>,<span class='st'>"female"</span>,<span class='fl'>1971</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Downloading nLx data for Spain, years 1971, gender female</div><div class='output co'>#&gt; <span class='message'>New names:</span>
#&gt; <span class='message'>* NA -&gt; ...1</span></div><div class='input'><span class='va'>Age_nLx</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='names2age.html'>names2age</a></span><span class='op'>(</span><span class='va'>nLx</span><span class='op'>)</span>

<span class='co'># India Males, 1991</span>
<span class='va'>Pop</span>        <span class='op'>&lt;-</span> <span class='fu'><a href='smooth_age_5.html'>smooth_age_5</a></span><span class='op'>(</span><span class='va'>pop1m_ind</span>,
                           Age <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>100</span>,
                           method <span class='op'>=</span> <span class='st'>"Arriaga"</span><span class='op'>)</span>
<span class='va'>Pop80</span>      <span class='op'>&lt;-</span> <span class='fu'><a href='groupOAG.html'>groupOAG</a></span><span class='op'>(</span><span class='va'>Pop</span>, <span class='fu'><a href='names2age.html'>names2age</a></span><span class='op'>(</span><span class='va'>Pop</span><span class='op'>)</span>, <span class='fl'>80</span><span class='op'>)</span>
<span class='va'>Age</span>        <span class='op'>&lt;-</span> <span class='fu'><a href='names2age.html'>names2age</a></span><span class='op'>(</span><span class='va'>Pop80</span><span class='op'>)</span>
<span class='va'>AgeInt</span>     <span class='op'>&lt;-</span> <span class='fu'><a href='age2int.html'>age2int</a></span><span class='op'>(</span><span class='va'>Age</span>, OAvalue <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='va'>nLx</span>        <span class='op'>&lt;-</span> <span class='fu'><a href='downloadnLx.html'>downloadnLx</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='st'>"India"</span>,<span class='st'>"male"</span>,<span class='fl'>1991</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Downloading nLx data for India, years 1991, gender male</div><div class='output co'>#&gt; <span class='message'>New names:</span>
#&gt; <span class='message'>* NA -&gt; ...1</span></div><div class='input'><span class='va'>Age_nLx</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='names2age.html'>names2age</a></span><span class='op'>(</span><span class='va'>nLx</span><span class='op'>)</span>
<span class='va'>AgeInt_nLx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='age2int.html'>age2int</a></span><span class='op'>(</span><span class='va'>Age_nLx</span>,OAvalue <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='va'>Pop_fit</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='groupAges.html'>groupAges</a></span><span class='op'>(</span><span class='va'>Pop80</span>, <span class='va'>Age</span>, N <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"60"</span>,<span class='st'>"70"</span><span class='op'>)</span><span class='op'>]</span>
<span class='va'>Age_fit</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>60</span>,<span class='fl'>70</span><span class='op'>)</span>
<span class='va'>AgeInt_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>10</span><span class='op'>)</span>

<span class='va'>Standard</span> <span class='op'>&lt;-</span> <span class='fu'>OPAG_fit_stable_standard</span><span class='op'>(</span>
             <span class='va'>Pop_fit</span>,
             <span class='va'>Age_fit</span>,
             <span class='va'>AgeInt_fit</span>,
             nLx <span class='op'>=</span> <span class='va'>nLx</span>,
             Age_nLx <span class='op'>=</span> <span class='va'>Age_nLx</span>,
             AgeInt_nLx <span class='op'>=</span> <span class='va'>AgeInt_nLx</span>,
             method <span class='op'>=</span> <span class='st'>"uniform"</span>,
             continuous <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># A visual comparison:</span>
<span class='va'>nL60</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rescale_vector.html'>rescale_vector</a></span><span class='op'>(</span><span class='va'>nLx</span><span class='op'>[</span><span class='va'>Age_nLx</span> <span class='op'>&gt;=</span> <span class='fl'>60</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>St60p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rescale_vector.html'>rescale_vector</a></span><span class='op'>(</span> <span class='va'>Standard</span><span class='op'>$</span><span class='va'>Standard</span><span class='op'>[</span><span class='va'>Age_nLx</span> <span class='op'>&gt;=</span> <span class='fl'>60</span><span class='op'>]</span> <span class='op'>)</span>
<span class='va'>ages_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>60</span>,<span class='fl'>100</span>,by<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ages_plot</span>,<span class='va'>nL60</span>, type <span class='op'>=</span> <span class='st'>'l'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>ages_plot</span>, <span class='va'>St60p</span>, col <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tim Riffe, José Manuel Aburto, Ilya Kashnitsky, Monica Alexander, Marius D. Pascariu, Sara Hertog, Sean Fennell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


